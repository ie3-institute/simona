tasks.register('checkBranchName') {
  doLast {
    if (!project.hasProperty('branchName')) {
      throw new GradleException("Error: Missing required property 'branchName'.")
    }

    def branchName = project.property('branchName')

    def patterns = [
            /^[a-z]{2}\\/#[0-9]+(?:-.+)?$/,
            /.*main/,
            /^dependabot\/.*$/,
            /.*hotfix\/\pL{2}\/#\d+.*/,
            /^(developer|develop|dev)$/,
            /.*rel\/.*/
    ]

    def isValid = patterns.any { pattern -> branchName.matches(pattern) }

    if (!isValid) {
      throw new GradleException("Error: Check Branch name format (e.g., ps/#1337-FeatureName).")
    }

    println "Branch name is $branchName"
  }
}
